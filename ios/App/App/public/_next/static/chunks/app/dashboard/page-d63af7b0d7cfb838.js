(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{817:(e,o,t)=>{"use strict";t.d(o,{default:()=>f});var a=t(5155),n=t(2115),i=t(2643),r=t(6267);class s{async requestPermissions(){return r.Ii.isNativePlatform()?(console.log("\uD83D\uDCF1 Native platform - MediaStyle service will handle permissions"),{granted:!0}):"geolocation"in navigator?{granted:!0}:{granted:!1}}async startWatching(e){return(this.onLocationUpdate=e,r.Ii.isNativePlatform())?(console.log("� Native platform - MediaStyle service will handle background tracking"),"media-style-service-active"):(console.log("\uD83C\uDF10 Starting web geolocation tracking..."),this.startWebGeolocation(e))}async stopWatching(){r.Ii.isNativePlatform()?console.log("� Native platform - MediaStyle service will handle stopping"):this.watchId&&(navigator.geolocation.clearWatch(Number(this.watchId)),this.watchId=null),this.onLocationUpdate=null}startWebGeolocation(e){if("geolocation"in navigator)return this.watchId=navigator.geolocation.watchPosition(o=>{e({coords:{latitude:o.coords.latitude,longitude:o.coords.longitude,accuracy:o.coords.accuracy},timestamp:Date.now()})},e=>console.error("❌ Web geolocation error:",e),{enableHighAccuracy:!0,timeout:15e3,maximumAge:0}),"web-geolocation-active";throw Error("Geolocation not supported")}async getCurrentPosition(){if(!r.Ii.isNativePlatform())return new Promise((e,o)=>{navigator.geolocation.getCurrentPosition(o=>e({coords:{latitude:o.coords.latitude,longitude:o.coords.longitude,accuracy:o.coords.accuracy},timestamp:Date.now()}),o,{enableHighAccuracy:!0,timeout:15e3,maximumAge:0})});try{var e,o,a,n;let{Geolocation:i}=await t.e(863).then(t.bind(t,1863)),r=await i.getCurrentPosition({enableHighAccuracy:!0,timeout:15e3,maximumAge:0});return{coords:{latitude:r.coords.latitude,longitude:r.coords.longitude,accuracy:r.coords.accuracy,altitude:null!=(e=r.coords.altitude)?e:void 0,altitudeAccuracy:null!=(o=r.coords.altitudeAccuracy)?o:void 0,heading:null!=(a=r.coords.heading)?a:void 0,speed:null!=(n=r.coords.speed)?n:void 0},timestamp:r.timestamp||Date.now()}}catch(e){throw console.error("❌ Capacitor geolocation getCurrentPosition failed:",e),e}}isNativePlatform(){return r.Ii.isNativePlatform()}constructor(){this.onLocationUpdate=null,this.handleVisibilityChange=()=>{document.hidden?console.log("\uD83C\uDF19 App backgrounded - Background Geolocation continues tracking"):console.log("☀️ App foregrounded - Background Geolocation still active")},this.watchId=null,"undefined"!=typeof document&&document.addEventListener("visibilitychange",this.handleVisibilityChange)}}new s;class l{async requestDisableBatteryOptimizations(){if(!r.Ii.isNativePlatform())return console.log("\uD83C\uDF10 Web platform - battery optimizations not applicable"),!0;try{let{registerPlugin:e}=await Promise.resolve().then(t.bind(t,6267)),o=e("BatteryOptimization"),{ignored:a}=await o.isBatteryOptimizationIgnored();if(a)return console.log("✅ Battery optimizations already disabled"),!0;let{granted:n}=await o.requestDisableBatteryOptimizations();return n?console.log("✅ Battery optimization exemption granted"):console.log("⚠️ Battery optimization exemption denied"),n}catch(e){return console.warn("⚠️ Battery optimization request failed:",e),!1}}showBatteryOptimizationInstructions(){return'\nTo ensure reliable background location tracking:\n\n1. Go to Settings > Apps > Location Monitor\n2. Tap on "Battery" or "Battery Usage"\n3. Select "Don\'t optimize" or "Allow background activity"\n4. Confirm the setting\n\nThis prevents Android from killing the app in the background.\n    '.trim()}async hasAggressivePowerManagement(){if(!r.Ii.isNativePlatform())return!1;try{var e;let{Device:o}=await t.e(484).then(t.bind(t,1484)),a=await o.getInfo(),n=(null==(e=a.manufacturer)?void 0:e.toLowerCase())||"";return["xiaomi","huawei","honor","oppo","vivo","oneplus","samsung","sony","asus","meizu","letv","nokia"].some(e=>n.includes(e))}catch(e){return console.warn("Could not detect device manufacturer:",e),!1}}}let c=new l,d=function(e){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},[a,l]=(0,n.useState)(null),[d,u]=(0,n.useState)(null),[g,m]=(0,n.useState)(!1),[h,p]=(0,n.useState)("prompt"),[f,y]=(0,n.useState)(!1),[w,v]=(0,n.useState)(navigator.onLine),x=(0,n.useRef)(0),b=(0,n.useRef)(0),k=(0,n.useRef)(null),N=(0,n.useRef)(null),j=(0,i.U)(),I=(0,n.useMemo)(()=>new s,[]),{onLocationUpdate:S}=o,L=(0,n.useCallback)(async()=>{try{let e=await I.requestPermissions();p(e.granted?"granted":"denied")}catch(e){console.warn("Could not query geolocation permission:",e),p("denied")}},[I]),P=(0,n.useCallback)(async function(o){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)return void console.warn("No userId provided for location update");if(!navigator.onLine&&!t)return void console.log("\uD83D\uDCE1 Offline - queueing location update for when connection returns");let a=Date.now();if(!t&&a-b.current<5e3)return void console.log("⏱️ Location update throttled, skipping database write");b.current=a,console.log("\uD83C\uDF0D Updating location in DB for user:",e),console.log("\uD83D\uDCCD Position:",o.coords.latitude,o.coords.longitude),console.log("\uD83C\uDFAF Accuracy:",o.coords.accuracy?"\xb1".concat(Math.round(o.coords.accuracy),"m"):"Unknown"),console.log("\uD83C\uDF10 Network status:",navigator.onLine?"Online":"Offline");try{console.log("\uD83D\uDD04 Upserting location record (single record per user)...");let{error:t}=await j.from("user_locations").upsert({user_id:e,latitude:o.coords.latitude,longitude:o.coords.longitude,accuracy:o.coords.accuracy,timestamp:new Date().toISOString(),is_active:!0},{onConflict:"user_id"});if(t)throw console.error("❌ Error upserting location:",t),console.error("❌ Upsert error details:",{message:t.message,code:t.code,details:t.details,hint:t.hint}),t;console.log("✅ Location record upserted successfully (single record per user)"),console.log("\uD83D\uDD0D Verifying location record...");let{data:a,error:n}=await j.from("user_locations").select("id, is_active, timestamp").eq("user_id",e).eq("is_active",!0).limit(1).single();n?console.error("❌ Error verifying location record:",n):a?console.log("✅ Verification successful - Active record found:",{id:a.id,is_active:a.is_active,timestamp:a.timestamp}):console.error("❌ Verification failed - No active record found!"),S&&S()}catch(t){console.error("Failed to update location in database:",t),console.error("Error details:",{message:null==t?void 0:t.message,code:null==t?void 0:t.code,details:null==t?void 0:t.details,hint:null==t?void 0:t.hint,userId:e,coords:{lat:o.coords.latitude,lng:o.coords.longitude,accuracy:o.coords.accuracy}})}},[e,j,S]),A=(0,n.useCallback)(async()=>{if(!e||!f)return void console.log("\uD83D\uDC93 Heartbeat skipped - not sharing or no userId");if(!navigator.onLine)return void console.log("\uD83D\uDC93 Heartbeat skipped - offline");console.log("\uD83D\uDC93 Sending heartbeat to keep stationary user online (user:",e,")");try{let{error:o}=await j.from("user_locations").update({timestamp:new Date().toISOString(),is_active:!0}).eq("user_id",e);o?console.error("❌ Heartbeat error:",o):console.log("✅ Heartbeat sent successfully - user stays online while stationary")}catch(e){console.error("❌ Heartbeat failed:",e)}},[e,f,j]),C=(0,n.useCallback)(async()=>{if(e){console.log("\uD83D\uDD34 Marking user offline:",e);try{await j.from("user_locations").update({is_active:!1,timestamp:new Date().toISOString()}).eq("user_id",e).eq("is_active",!0)}catch(e){console.error("Failed to mark user offline:",e)}}},[e,j]),U=(0,n.useCallback)(async()=>{m(!0),u(null);try{let e=await I.getCurrentPosition();e?(l(e),P(e,!0)):u("Unable to get current position"),m(!1)}catch(o){console.error("getCurrentPosition error:",o);let e="An error occurred while retrieving location";if(o&&"object"==typeof o&&"code"in o){let t=o.code;switch(t){case 1:e="Location access denied by user",p("denied");break;case 2:e="Location information is unavailable";break;case 3:e="Location request timed out";break;default:e="Unknown location error (code: ".concat(t,")")}}else o&&"object"==typeof o&&"message"in o&&(e=o.message);u(e),m(!1)}},[I,P]),E=(0,n.useCallback)(async()=>{if(!e)return console.warn("❌ No userId provided for location watching - user must be logged in"),u("Please log in to start location sharing"),null;console.log("\uD83D\uDE80 Starting background location tracking for user:",e),u(null),m(!0);try{if(r.Ii.isNativePlatform()){console.log("\uD83D\uDCF1 Starting background geolocation with notification..."),console.log("\uD83D\uDD0B Requesting battery optimization exemption..."),await c.requestDisableBatteryOptimizations()||console.warn("⚠️ Battery optimization exemption not granted - background tracking may be unreliable");try{let{registerPlugin:e}=await Promise.resolve().then(t.bind(t,6267)),o=e("BackgroundGeolocation"),a=0,n=null,i=null,r=await o.addWatcher({backgroundMessage:"\uD83D\uDCCD Location Monitor is tracking your location",backgroundTitle:"Location Tracking Active",requestPermissions:!0,stale:!1,distanceFilter:10,enableHighAccuracy:!0},(e,o)=>{if(o){console.error("❌ Background location error:",o),u("Background location error: "+o.message);return}if(e){console.log("\uD83D\uDCCD Background location update:",e.latitude,e.longitude),console.log("\uD83C\uDFAF Location accuracy:",e.accuracy?"\xb1".concat(Math.round(e.accuracy),"m"):"Unknown");let o=e.accuracy||999;if(o>20)return void console.warn("⚠️ Location accuracy too low:","\xb1".concat(Math.round(o),"m - skipping update"));a=Date.now();let t={coords:{latitude:e.latitude,longitude:e.longitude,accuracy:e.accuracy||0,altitude:e.altitude||void 0,altitudeAccuracy:e.altitudeAccuracy||void 0,heading:e.bearing||void 0,speed:e.speed||void 0},timestamp:e.time||Date.now()};i=t,N.current=t,l(t),P(t),x.current=0}});return n=setInterval(async()=>{let e=Date.now();if(e-a>=45e3){console.log("⏰ Timer-based location check (background/stationary)");try{let o=await I.getCurrentPosition();if(o){console.log("\uD83C\uDFAF Timer location accuracy:",o.coords.accuracy?"\xb1".concat(Math.round(o.coords.accuracy),"m"):"Unknown");let t=o.coords.accuracy||999;if(t>30)console.warn("⚠️ Timer location accuracy too low:","\xb1".concat(Math.round(t),"m - using cached position instead"));else{i=o,l(o),P(o),a=e;return}}}catch(o){if(console.warn("Timer location update failed:",o),i){let o={...i,timestamp:e};console.log("\uD83D\uDCCD Using cached position for timer update"),l(o),P(o),a=e}}}},45e3),console.log("✅ Background geolocation started with watcher ID:",r),m(!1),y(!0),console.log("\uD83D\uDC93 Starting heartbeat timer for stationary user detection"),k.current=setInterval(()=>{A()},18e4),{watcherId:r,timerInterval:n}}catch(e){throw console.error("❌ Background geolocation failed:",e),u("Failed to start background location: "+e.message),e}}{console.log("\uD83C\uDF10 Using web geolocation fallback...");let e=await I.startWatching(e=>{console.log("Location updated:",e.coords.latitude,e.coords.longitude),x.current=0,m(!1),l(e),N.current=e,P(e)});return console.log("Web watch started with ID:",e),y(!0),console.log("\uD83D\uDC93 Starting heartbeat timer for stationary user detection"),k.current=setInterval(()=>{A()},18e4),e}}catch(o){console.error("❌ Start watching error:",o);let e="Failed to start location monitoring: ";if(o&&"object"==typeof o&&"code"in o){let t=o.code;switch(t){case 1:e+="Permission denied - Please allow location access",p("denied");break;case 2:e+="Position unavailable - GPS signal not available";break;case 3:e+="Location request timed out";break;default:e+="Unknown error (code: ".concat(t,")")}}else o&&"object"==typeof o&&"message"in o?e+=o.message:e+="Please check your location settings and try again.";return u(e),m(!1),null}},[e,I,P]),B=(0,n.useCallback)(async function(e){let o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];console.log("\uD83D\uDED1 Stopping location tracking...");try{if(r.Ii.isNativePlatform()){console.log("\uD83D\uDCF1 Stopping background geolocation...");try{let{registerPlugin:o}=await Promise.resolve().then(t.bind(t,6267)),a=o("BackgroundGeolocation");e&&("string"==typeof e?(await a.removeWatcher({id:e}),console.log("✅ Background geolocation watcher removed:",e)):(await a.removeWatcher({id:e.watcherId}),console.log("✅ Background geolocation watcher removed:",e.watcherId),e.timerInterval&&(clearInterval(e.timerInterval),console.log("✅ Timer interval cleared"))))}catch(e){console.warn("Background geolocation stop failed:",e)}y(!1)}else console.log("\uD83C\uDF10 Stopping web geolocation tracking..."),await I.stopWatching(),console.log("✅ Web location tracking stopped"),y(!1);k.current&&(clearInterval(k.current),k.current=null,console.log("✅ Heartbeat interval cleared")),o&&(await C(),console.log("\uD83D\uDD34 User marked offline in database"))}catch(e){console.error("❌ Error stopping location watch:",e)}},[I,C]),_=(0,n.useCallback)(async()=>{if(r.Ii.isNativePlatform()&&!e&&f){console.log("\uD83D\uDC64 User not logged in - stopping any background tracking..."),y(!1);return}},[f,e]),O=(0,n.useCallback)(async()=>{try{let e=(await I.requestPermissions()).granted;return p(e?"granted":"denied"),e}catch(e){return console.error("Error requesting permissions:",e),p("denied"),!1}},[I]);return(0,n.useEffect)(()=>{L()},[L]),(0,n.useEffect)(()=>{let o=()=>{console.log("\uD83C\uDF10 Network connection restored"),v(!0),f&&e&&console.log("\uD83D\uDCE1 Resuming location sharing after connection restored")},t=()=>{console.log("\uD83D\uDCE1 Network connection lost - location updates will be queued"),v(!1)};return v(navigator.onLine),window.addEventListener("online",o),window.addEventListener("offline",t),()=>{window.removeEventListener("online",o),window.removeEventListener("offline",t)}},[f,e]),(0,n.useEffect)(()=>{r.Ii.isNativePlatform()&&_()},[_,e]),{position:a,error:d,loading:g,permission:h,isSharing:f,isOnline:w,getCurrentPosition:U,startWatching:E,stopWatching:B,requestPermission:O,markUserOffline:C,cleanup:(0,n.useCallback)(async()=>{console.log("\uD83E\uDDF9 Cleaning up location tracking on logout...");try{r.Ii.isNativePlatform()?console.log("\uD83D\uDCF1 Background geolocation will stop when app closes"):await I.stopWatching(),k.current&&(clearInterval(k.current),k.current=null,console.log("✅ Heartbeat interval cleared during cleanup")),e&&(console.log("\uD83D\uDD34 Marking user offline during cleanup..."),await C()),y(!1),l(null),u(null),console.log("✅ Location tracking cleanup completed")}catch(e){console.error("❌ Cleanup error:",e)}},[I,e,C])}};var u=t(4835),g=t(2652),m=t(4186),h=t(4516),p=t(5695);function f(){let[e,o]=(0,n.useState)(null),[t,r]=(0,n.useState)(null),[s,l]=(0,n.useState)(!0),[c,f]=(0,n.useState)(null),[y,w]=(0,n.useState)(!1),[v,x]=(0,n.useState)(!1),b=(0,i.U)(),k=(0,p.useRouter)(),{position:N,error:j,permission:I,isSharing:S,startWatching:L,stopWatching:P,requestPermission:A,cleanup:C}=d((null==e?void 0:e.id)||null,{onLocationUpdate:()=>{f(new Date),console.log("\uD83D\uDCCD Location update sent to server")}});(0,n.useEffect)(()=>{(async()=>{try{let{data:{user:e}}=await b.auth.getUser();if(!e)return void k.push("/login");let{data:t}=await b.from("users").select("*").eq("id",e.id).single();t&&(o(t),console.log("✅ User profile loaded:",t.name))}catch(e){console.error("Error loading user profile:",e)}finally{l(!1)}})()},[b,k]),(0,n.useEffect)(()=>{(async()=>{if(e&&!S&&!t&&!y&&!v){console.log("\uD83D\uDE80 Auto-starting location tracking for logged in user:",e.name);try{if(("denied"===I||"prompt"===I)&&!await A())return void console.warn("⚠️ Location permission denied - cannot auto-start tracking");let e=await L();e&&(r(e),console.log("✅ Auto-started location tracking with ID:",e))}catch(e){console.error("❌ Failed to auto-start location tracking:",e)}}})()},[e,S,t,y,v,I,A,L]);let U=async()=>{if(null==e?void 0:e.id)try{if(l(!0),S)console.log("\uD83D\uDED1 Stopping location sharing - going offline..."),t&&(await P(t,!0),r(null)),w(!0),setTimeout(()=>{console.log("\uD83D\uDD04 Force checking location sharing state after stop button...")},500),console.log("✅ Location sharing stopped - user marked offline");else{if(console.log("\uD83D\uDE80 Starting location sharing..."),"denied"===I&&!await A())return void alert("Location permission is required to share your location");let e=await L();e&&(r(e),w(!1),console.log("✅ Location sharing started"))}}catch(e){console.error("Error toggling location:",e),alert("Failed to toggle location sharing")}finally{l(!1)}},E=async()=>{try{console.log("\uD83D\uDEAA User signing out - cleaning up location tracking..."),x(!0),S&&t&&(console.log("\uD83D\uDED1 Stopping active location tracking before logout..."),await P(t,!0),r(null)),(null==e?void 0:e.id)&&(console.log("\uD83D\uDDD1️ Deleting user location record on logout..."),await b.from("user_locations").delete().eq("user_id",e.id),console.log("✅ User location record deleted")),C&&(console.log("\uD83E\uDDF9 Running comprehensive cleanup..."),await C()),w(!1),r(null),await b.auth.signOut(),console.log("✅ Sign out completed, redirecting to login..."),k.push("/login")}catch(e){console.error("Error signing out:",e),x(!1)}};return s?(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,a.jsx)("div",{className:"text-gray-600",children:"Loading..."})}):(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)("div",{className:"bg-white shadow",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex justify-between items-center py-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Location Monitor"}),(0,a.jsxs)("p",{className:"text-gray-600",children:["Welcome back, ",(null==e?void 0:e.name)||"User"]})]}),(0,a.jsxs)("button",{onClick:E,disabled:v,className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-opacity duration-200",children:[(0,a.jsx)(u.A,{className:"h-4 w-4 mr-2"}),v?"Signing Out...":"Sign Out"]})]})})}),(0,a.jsxs)("div",{className:"max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8",children:[j&&(0,a.jsx)("div",{className:"mb-4 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded",children:j}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[(0,a.jsx)("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:(0,a.jsx)("div",{className:"p-5",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)(g.A,{className:"h-8 w-8 text-gray-400"})}),(0,a.jsx)("div",{className:"ml-5 w-0 flex-1",children:(0,a.jsxs)("dl",{children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Location Status"}),(0,a.jsx)("dd",{className:"text-lg font-medium ".concat(S?"text-green-600":"text-red-600"),children:S?"Sharing":"Not Sharing"})]})})]})})}),(0,a.jsx)("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:(0,a.jsx)("div",{className:"p-5",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)(m.A,{className:"h-8 w-8 text-gray-400"})}),(0,a.jsx)("div",{className:"ml-5 w-0 flex-1",children:(0,a.jsxs)("dl",{children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Last Update"}),(0,a.jsx)("dd",{className:"text-lg font-medium text-gray-900",children:c?c.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit"}):"Never"})]})})]})})})]}),(0,a.jsx)("div",{className:"bg-white shadow rounded-lg",children:(0,a.jsxs)("div",{className:"px-4 py-5 sm:p-6",children:[(0,a.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900 mb-4",children:"Location Sharing Control"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-6",children:"You have full control over your location sharing. You can start or stop sharing at any time, even when the app is running in the background. Use the button below or the notification controls."}),(0,a.jsxs)("div",{className:"mb-6 p-4 rounded-lg border-2 border-dashed border-gray-200",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"w-3 h-3 rounded-full mr-3 ".concat(v?"bg-yellow-500":S?"bg-green-500 animate-pulse":"bg-red-500")}),(0,a.jsx)("span",{className:"text-lg font-semibold ".concat(v?"text-yellow-600":S?"text-green-600":"text-red-600"),children:v?"\uD83D\uDD04 SIGNING OUT...":S?"\uD83D\uDFE2 ONLINE - ACTIVELY SHARING":"\uD83D\uDD34 OFFLINE - NOT SHARING"})]}),S&&!v&&(0,a.jsx)("span",{className:"text-sm text-gray-500 bg-gray-100 px-2 py-1 rounded",children:"Tracking in background"})]}),v?(0,a.jsx)("p",{className:"text-sm text-gray-600 mt-2",children:"Stopping location tracking and signing out..."}):S?(0,a.jsx)("p",{className:"text-sm text-gray-600 mt-2",children:"Your location is being shared and will continue even when you minimize the app. You can go offline anytime using the button below."}):(0,a.jsx)("p",{className:"text-sm text-gray-600 mt-2",children:"You are currently offline. Other users cannot see your location on the map. Click the button below to come online and start sharing."})]}),N&&(0,a.jsxs)("div",{className:"mb-4 p-3 bg-gray-50 rounded-md",children:[(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["Current position: ",N.coords.latitude.toFixed(6),", ",N.coords.longitude.toFixed(6)]}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:["Accuracy: \xb1",Math.round(N.coords.accuracy)," meters"]})]}),(0,a.jsxs)("div",{className:"flex space-x-4",children:[(0,a.jsxs)("button",{onClick:U,disabled:s||"denied"===I||v,className:"inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-md shadow-sm ".concat(v?"text-white bg-gray-500 cursor-not-allowed":S?"text-white bg-red-600 hover:bg-red-700 focus:ring-red-500":"text-white bg-green-600 hover:bg-green-700 focus:ring-green-500"," disabled:opacity-50 disabled:cursor-not-allowed focus:outline-none focus:ring-2 focus:ring-offset-2 transition-colors duration-200"),children:[(0,a.jsx)(h.A,{className:"h-5 w-5 mr-2"}),v?"\uD83D\uDD04 Signing Out...":S?"\uD83D\uDD34 Go Offline":"\uD83D\uDCCD Start Sharing Location"]}),"denied"===I&&(0,a.jsx)("button",{onClick:A,className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"Request Permission"})]}),"denied"===I&&(0,a.jsx)("p",{className:"mt-2 text-sm text-red-600",children:"Location permission denied. Please enable location access in your browser settings."})]})}),(0,a.jsx)("div",{className:"mt-8 bg-white shadow rounded-lg",children:(0,a.jsxs)("div",{className:"px-4 py-5 sm:p-6",children:[(0,a.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900 mb-4",children:"Profile Information"}),(0,a.jsxs)("dl",{className:"grid grid-cols-1 gap-x-4 gap-y-6 sm:grid-cols-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:"Name"}),(0,a.jsx)("dd",{className:"mt-1 text-sm text-gray-900",children:(null==e?void 0:e.name)||"N/A"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:"Email"}),(0,a.jsx)("dd",{className:"mt-1 text-sm text-gray-900",children:(null==e?void 0:e.email)||"N/A"})]})]})]})})]})]})}},2643:(e,o,t)=>{"use strict";t.d(o,{U:()=>n});var a=t(3865);function n(){let e="https://grkutsjbksioleoxfqnp.supabase.co",o="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imdya3V0c2pia3Npb2xlb3hmcW5wIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTM0MjUxMDUsImV4cCI6MjA2OTAwMTEwNX0.kCTMxAqhAX53Vcw2AhV1gY4oEdADIh-N9FXDpk9rmWg";if(!e)throw Error("Missing env.NEXT_PUBLIC_SUPABASE_URL");if(!o)throw Error("Missing env.NEXT_PUBLIC_SUPABASE_ANON_KEY");return(0,a.createBrowserClient)(e,o)}},7716:(e,o,t)=>{Promise.resolve().then(t.bind(t,817))}},e=>{e.O(0,[271,234,441,964,358],()=>e(e.s=7716)),_N_E=e.O()}]);